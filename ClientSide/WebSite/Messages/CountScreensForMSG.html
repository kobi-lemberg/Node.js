<div>
    <p>
    <h2>Advertisement distribution</h2>
    </p>

    <table class="table">
        <tr>
            <th>
                Message
            </th>
            <th>
                Number Of scrrens
            </th>
        </tr>

        <tr ng-repeat="msg in sumMessageInScreens">
            <td>
                {{msg._id}}
            </td>
            <td>
                {{msg.count}}
            </td>
        </tr>

    </table>

    <div>
        <br />
        <a class="Button" href="/#/Advertisement/">Back to Advertisement</a>
    </div>
    <div id="Chart"></div>

    <script>





        var setDataToCharts=(function() {
            var scope = angular.element(document.querySelector(".table")).scope();
            var t  = scope.sumMessageInScreens;
            console.log("t:"+t);
            var randomColors=["#830909","#bf273e","#daca61","#0c6197","#4daa4b","#90c469","#e4a14b","#e98125","#cb2121","#830909","#923e99","#ae83d5","#ce2aeb","#2484c1"];
            console.log("starting chart");

            var finalChartData = [];

            console.log("starting chart");
            $(t).each(function (index,value) {
                console.log("Index:"+index);
                console.log("value:"+value);
                finalChartData.push({
                    "label": value._id,
                    "value": value.count,
                    "color": randomColors[index]
                });

            });

            console.log(JSON.stringify(finalChartData));
            var pie = new d3pie("Chart", {
                "header": {
                    "title": {
                        "text": "Advertisements",
                        "fontSize": 34,
                        "font": "courier"
                    },
                    "subtitle": {
                        "text": "Advertisement distribution ",
                        "color": "#999999",
                        "fontSize": 10,
                        "font": "courier"
                    },
                    "location": "pie-center",
                    "titleSubtitlePadding": 10
                },
                "footer": {
                    "text": "Advertisement distribution",
                    "color": "#999999",
                    "fontSize": 10,
                    "font": "open sans",
                    "location": "bottom-left"
                },
                "size": {
                    "canvasWidth": 590,
                    "pieInnerRadius": "95%",
                    "pieOuterRadius": "70%"
                },
                "data": {
                    "sortOrder": "label-desc",
                    "content": finalChartData
                },
                "labels": {
                    "outer": {
                        "format": "label-percentage1",
                        "pieDistance": 20
                    },
                    "inner": {
                        "format": "none"
                    },
                    "mainLabel": {
                        "fontSize": 11
                    },
                    "percentage": {
                        "color": "#999999",
                        "fontSize": 11,
                        "decimalPlaces": 0
                    },
                    "value": {
                        "color": "#cccc43",
                        "fontSize": 11
                    },
                    "lines": {
                        "enabled": true,
                        "color": "#777777"
                    },
                    "truncation": {
                        "enabled": true
                    }
                },
                "effects": {
                    "pullOutSegmentOnClick": {
                        "effect": "linear",
                        "speed": 400,
                        "size": 8
                    }
                },
                "misc": {
                    "colors": {
                        "segmentStroke": "#000000"
                    }
                }
            });
        });
        setDataToCharts();
    </script>
</div>